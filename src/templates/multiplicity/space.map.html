{% extends 'multiplicity/base.html' %}
{% load static %}

{% block title %}{{ info.name }} | {{ info.country }}{% endblock %}
{% block container %}stretch-bg-head{% endblock %}

{% block content %}
    <ul class="nav nav-tabs nav-justified ">
        <li{% if tab == 'boundaries' %} class="active"{% endif %}><a href="{% url 'multiplicity:map' info.slug %}">Boundaries</a></li>
        <li><a href="http://">Infrastructure</a></li>
        <li><a href="http://">Other maps</a></li>
      </ul>

<div class="panel">

  <div class="panel-content">
      <div id="map"></div>
  </div>

</div>

<div class="row">
  <div class="col-lg-8">
    <div class="panel">
      <div class="panel-body">
        <h3>{{ boundary.name }}</h3>
        {{ boundary.description }}
      </div>
    </div>
  </div>
  <div class="col-lg-4">
    <div class="panel panel-colorful panel-pink">
      <div class="panel-body">
        <h3>Download</h3>
        <p>
          You can download the coordinates as GeoJSON file below.
        </p>
        <p>
          <a href="{% url 'multiplicity:download_location' info.slug boundary.id %}" class="btn btn-default"><i class="fa fa-download"></i> Download</a>
        </p>
      </div>
    </div>
  </div>
</div>



<div class="panel">

  <div class="panel-title">
    <p>{{ boundary.description }}</p>
  </div>

</div>

{% endblock %}

{% block head %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" />
<style type="text/css">
#map{height:65vh;border:1px solid #ccc}
</style>
{% endblock %}

{% block sidebar %}
{% include 'multiplicity/sidebar.default.html' %}

{% endblock %}

{% block pagehead %}
<div id="page-head">

    <div id="page-title">
        <h1 class="page-header text-overflow">{{ info.name }}</h1>
    </div>

    <ol class="breadcrumb">
        <li><a href="./"><i class="pli-home"></i></a></li>
        <li><a href="{% url 'multiplicity:index' %}">Cities</a></li>
        <li><a href="{% url 'multiplicity:city' info.slug %}">{{ info.name }}</a></li>
        <li><a href="{% url 'multiplicity:map' info.slug %}">Maps</a></li>
        <li class="active">{{ page|title }}</li>
    </ol>

</div>
{% endblock %}

{% block footer %}
  {% if boundary %}
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"></script>
    <script type="text/javascript">

      {% if boundary %}
        var map = L.map('map');
      {% else %}
        var map = L.map('map').setView([{{ info.location.lat }}, {{ info.location.lng }}], {{ boundary.default_zoom }});
      {% endif %}

      var geojson = {{ boundary.geojson|safe }}
      var geojsonlayer = L.geoJSON(geojson).addTo(map);

      L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={{ MAPBOX_API_KEY }}', {
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
          '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
          'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
        {% if page == "satellite" %}
          id: 'mapbox.satellite'
        {% else %}
          id: 'mapbox.streets'
        {% endif %}
      }).addTo(map);

        map.scrollWheelZoom.disable();
        map.fitBounds(geojsonlayer.getBounds());
    </script>
  {% endif %}
{% endblock %}
