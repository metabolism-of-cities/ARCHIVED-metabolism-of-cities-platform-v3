<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;subset=latin" rel="stylesheet">

	<title>Test</title>

	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>

	<style>
		svg	{
			max-width: 90vw;
			max-height: 90vh;
		}

		.red {
			fill: #f44336;
		}

		.purple {
			fill: #ab47bc;
		}

		.green {
			fill: #8bc34a;
		}

		.yellow {
			fill: #ffb300;
		}

		.blue {
			fill: #03a9f4;
		}

		rect {
			transition: x 0.5s, y 0.5s, width 0.5s, height 0.5s;
		}
	</style>

</head>
<body>
	<button id="hit">Hit me!</button>

	<svg viewBox="0 0 700 900">




	  <rect style="fill:#f9f9f9" stroke="#666" stroke-width="0.5" width="698" height="600" x="1" y="150" />
	  <text text-anchor="middle" style="font-size:40px;font-family:'Open Sans'" x="350" y="475">Cape Town</text>

	  <!-- inputs box -->
	  <rect width="660" height="390" x="20" y="20" style="fill: none" stroke="#333" stroke-dasharray="4"/>

	  <!-- Imports -->
	  <text text-anchor="middle" style="font-size:25px;font-family:'Open Sans';" x="200" y="55">Imports</text>
	  <rect class="importsTotal" style="fill:#333" width="200" height="2" x="100" y="68" />

	  <rect style="fill:#999" width="220" height="16" x="90" y="360" />
	  <rect style="fill:#666" width="220" height="4" x="90" y="376" />
	  <rect class="importsTotal" style="fill:#fff" width="200" height="1" x="100" y="370" />

	  <!-- bars -->
	  <a href=""><rect class="imports red" x="100" y="70" width="40" height="300"/></a>
	  <a href=""><rect class="imports blue" x="140" y="70" width="40" height="300"/></a>
	  <a href=""><rect class="imports green" x="180" y="70" width="40" height="300"/></a>
	  <a href=""><rect class="imports purple" x="220" y="70" width="40" height="300"/></a>
	  <a href=""><rect class="imports yellow" x="260" y="70" width="40" height="300"/></a>

	  <!-- Local extraction -->
	  <text text-anchor="middle" style="font-size:25px;font-family:'Open Sans';" x="500" y="195">Local extraction</text>
	  <rect class="extractionTotal" style="fill:#333" width="200" height="2" x="400" y="208" />

	  <rect style="fill:#999" width="220" height="16" x="390" y="360" />
	  <rect style="fill:#666" width="220" height="4" x="390" y="376" />
	  <rect class="extractionTotal" style="fill:#fff" width="200" height="1" x="400" y="370" />

	  <!-- bars -->
	  <a href=""><rect class="extraction red" x="400" y="210" width="40" height="160"/></a>
	  <a href=""><rect class="extraction blue" x="440" y="210" width="40" height="160"/></a>
	  <a href=""><rect class="extraction green" x="480" y="210" width="40" height="160"/></a>
	  <a href=""><rect class="extraction purple" x="520" y="210" width="40" height="160"/></a>
	  <a href=""><rect class="extraction yellow" x="560" y="210" width="40" height="160"/></a>

	  <!-- Exports -->
	  <text style="font-size:25px;font-family:'Open Sans';" x="140" y="875">Exports</text>
	  <rect class="exportsTotal" style="fill:#333" width="200" height="2" x="100" y="528" />

	  <rect style="fill:#999" width="220" height="16" x="90" y="820" />
	  <rect style="fill:#666" width="220" height="4" x="90" y="836" />
	  <rect class="exportsTotal" style="fill:#fff" width="200" height="1" x="100" y="830" />

	  <!-- bars -->
	  <a href=""><rect class="exports red" x="100" y="530" width="40" height="300"/></a>
	  <a href=""><rect class="exports blue" x="140" y="530" width="40" height="300"/></a>
	  <a href=""><rect class="exports green" x="180" y="530" width="40" height="300"/></a>
	  <a href=""><rect class="exports purple" x="220" y="530" width="40" height="300"/></a>
	  <a href=""><rect class="exports yellow" x="260" y="530" width="40" height="300"/></a>

	  <!-- Consumption -->
	  <text style="font-size:25px;font-family:'Open Sans';" x="420" y="730">Consumption</text>
	  <rect class="consumptionTotal" style="fill:#333" width="200" height="2" x="400" y="528" />

	  <rect style="fill:#999" width="220" height="16" x="390" y="680" />
	  <rect style="fill:#666" width="220" height="4" x="390" y="696" />
	  <rect class="consumptionTotal" style="fill:#fff" width="200" height="1" x="400" y="690" />

	  <!-- bars -->
	  <a href=""><rect class="consumption red" x="400" y="530" width="40" height="160"/></a>
	  <a href=""><rect class="consumption blue" x="440" y="530" width="40" height="160"/></a>
	  <a href=""><rect class="consumption green" x="480" y="530" width="40" height="160"/></a>
	  <a href=""><rect class="consumption purple" x="520" y="530" width="40" height="160"/></a>
	  <a href=""><rect class="consumption yellow" x="560" y="530" width="40" height="160"/></a>


	  <path
	     d="m 130.87106,49.436696 6.60715,6.629493 c 0.20982,0.209887 0.54911,0.209887 0.75893,0 l 6.60715,-6.629493 c 0.20983,-0.209887 0.20983,-0.549092 0,-0.75891 l -0.31695,-0.316925 c -0.20982,-0.209888 -0.54911,-0.209888 -0.75894,0 l -5.1518,5.178567 V 39.615292 c 0,-0.294612 -0.24105,-0.535702 -0.5357,-0.535702 h -0.44644 c -0.29464,0 -0.53571,0.240916 -0.53571,0.535702 v 13.924136 l -5.15179,-5.174106 c -0.20984,-0.209888 -0.54912,-0.209888 -0.75894,0 l -0.31695,0.316926 c -0.20983,0.205356 -0.20983,0.544629 0,0.754448 z m -1.58483,9.107187 v -0.357156 c 0,-0.294613 0.24105,-0.535708 0.53572,-0.535708 h 16.07146 c 0.29464,0 0.53572,0.240923 0.53572,0.535708 v 0.357156 c 0,0.294612 -0.24107,0.535707 -0.53572,0.535707 h -16.07146 c -0.29466,0 -0.53572,-0.240916 -0.53572,-0.535707 z"/>
	  <path
	     d="m 134.60635,872.26654 -6.55209,6.57421 c -0.20806,0.20808 -0.54453,0.20808 -0.75259,0 l -6.5521,-6.57421 c -0.20806,-0.20808 -0.20806,-0.54454 0,-0.7526 l 0.31433,-0.31434 c 0.20808,-0.20807 0.54453,-0.20807 0.75261,0 l 5.10884,5.13542 v -13.80807 c 0,-0.29219 0.23908,-0.53125 0.53127,-0.53125 h 0.44269 c 0.29219,0 0.53126,0.23906 0.53126,0.53125 v 13.80807 l 5.10885,-5.13098 c 0.20807,-0.20808 0.54454,-0.20808 0.7526,0 l 0.31433,0.31431 c 0.20807,0.20365 0.20807,0.54011 0,0.74819 z m -15.42839,-12.57293 v 0.35418 c 0,0.29218 0.23907,0.53124 0.53125,0.53124 h 15.9375 c 0.2922,0 0.53125,-0.23906 0.53125,-0.53124 v -0.35418 c 0,-0.29218 -0.23905,-0.53124 -0.53125,-0.53124 h -15.9375 c -0.29218,0 -0.53125,0.23906 -0.53125,0.53124 z"/>
	  <path
	     d="m 402.7594,178.98902 -2.95587,-2.95587 c -0.27227,-0.27227 -0.62969,-0.40821 -0.9875,-0.40821 -0.35782,0 -0.71485,0.13594 -0.98712,0.40821 l -1.14063,1.14024 c -0.66094,0.66133 -1.02071,1.54688 -1.02071,2.46251 0,0.95743 0.38242,1.63321 0.62344,1.98204 l -4.97229,4.9719 -2.20978,-2.20977 c -0.24414,-0.24414 -0.56406,-0.36602 -0.88399,-0.36602 -0.31992,0 -0.63984,0.12188 -0.88399,0.36602 l -2.65157,2.65157 c -1.95236,1.95275 -1.76759,7.07114 -0.8836,7.95513 0.38555,0.38554 1.57774,0.63828 2.96095,0.63828 1.78712,0 3.89338,-0.42149 4.99417,-1.52227 l 2.65158,-2.65158 c 0.48828,-0.48828 0.48828,-1.2797 0,-1.76759 l -2.20978,-2.20978 4.9719,-4.9719 c 0.34844,0.24063 1.02579,0.62344 1.98282,0.62344 0.91446,0 1.8004,-0.36016 2.46134,-1.02071 l 1.14024,-1.14063 c 0.54454,-0.54492 0.54454,-1.43047 3.9e-4,-1.97501 z m -11.88248,14.23016 c -1.43243,1.43204 -5.24847,1.27813 -6.17816,0.86953 -0.41563,-0.86406 -0.53086,-4.76721 0.87501,-6.17308 l 2.6504,-2.65157 h 10e-4 l 5.30316,5.30354 z m 10.9985,-13.13953 -1.14024,1.14024 c -2.06212,2.06212 -5.23831,-1.0875 -3.16252,-3.16251 l 1.14063,-1.14063 c 0.0566,-0.0567 0.15,-0.0567 0.20664,0 l 2.95588,2.95626 c 0.0563,0.0566 0.0563,0.15 -3.9e-4,0.20664 z"/>

	  <path
	     d="m 410.6327,723.82935 c 2.36607,0 4.28572,-1.91964 4.28572,-4.28571 0,-2.36608 -1.91965,-4.28572 -4.28572,-4.28572 -2.36607,0 -4.28571,1.91964 -4.28571,4.28572 0,2.36607 1.91964,4.28571 4.28571,4.28571 z m 0,-7.14286 c 1.57589,0 2.85714,1.28125 2.85714,2.85715 0,1.57588 -1.28125,2.85714 -2.85714,2.85714 -1.5759,0 -2.85714,-1.28126 -2.85714,-2.85714 0,-1.5759 1.28124,-2.85715 2.85714,-2.85715 z m -12.85714,7.14286 c 2.76338,0 5,-2.23661 5,-5 0,-2.7634 -2.23662,-5 -5,-5 -2.7634,0 -5,2.2366 -5,5 0,2.76339 2.2366,5 5,5 z m 0,-8.57143 c 1.96874,0 3.57143,1.60267 3.57143,3.57143 0,1.96874 -1.60269,3.57143 -3.57143,3.57143 -1.96876,0 -3.57143,-1.60269 -3.57143,-3.57143 0,-1.96876 1.60267,-3.57143 3.57143,-3.57143 z m 3.57588,9.46429 c -1.49107,0 -1.8616,0.53571 -3.57588,0.53571 -1.71429,0 -2.08483,-0.53571 -3.5759,-0.53571 -1.62053,0 -3.19643,0.72321 -4.12053,2.09374 -0.55357,0.82143 -0.875,1.80804 -0.875,2.87054 v 2 c 0,1.18303 0.95981,2.14286 2.14286,2.14286 h 12.85714 c 1.18303,0 2.14286,-0.95983 2.14286,-2.14286 v -2 c 0,-1.0625 -0.32143,-2.04911 -0.875,-2.87054 -0.92412,-1.37053 -2.5,-2.09374 -4.12055,-2.09374 z m 3.56698,6.96428 c 0,0.39286 -0.32143,0.71429 -0.71429,0.71429 h -12.85714 c -0.39286,0 -0.71429,-0.32143 -0.71429,-0.71429 v -2 c 0,-0.74107 0.21874,-1.45983 0.62946,-2.07143 0.61607,-0.91518 1.71428,-1.46428 2.93304,-1.46428 1.22322,0 1.66072,0.53571 3.58036,0.53571 1.91964,0 2.35714,-0.53571 3.57588,-0.53571 1.21876,0 2.31698,0.5491 2.93305,1.46428 0.41071,0.6116 0.62945,1.33036 0.62945,2.07143 v 2 z m 12.12945,-5.12947 c -0.77231,-1.14286 -2.08481,-1.74553 -3.43303,-1.74553 -1.24107,0 -1.55357,0.44643 -2.98214,0.44643 -1.42857,0 -1.74107,-0.44643 -2.98214,-0.44643 -0.58929,0 -1.16519,0.13386 -1.7009,0.3616 0.67857,0.6875 0.8259,1.05357 0.90178,1.1875 0.25448,-0.0714 0.51786,-0.116 0.79912,-0.116 0.97321,0 1.33928,0.44643 2.98214,0.44643 1.64286,0 2.00893,-0.44643 2.98214,-0.44643 0.9375,0 1.77679,0.41519 2.25,1.11607 0.31696,0.46876 0.4866,1.02233 0.4866,1.59376 v 1.66072 c 0,0.19642 -0.16071,0.35714 -0.35714,0.35714 h -8.21874 c 0,0.79017 0.0129,1.00446 -0.0714,1.42857 h 8.28571 c 0.9866,0 1.78572,-0.79911 1.78572,-1.78571 v -1.66519 c 0,-0.88839 -0.26786,-1.70981 -0.72769,-2.39286 z"/>
	</svg>


	<script>
		function getRandomInt(max) {
		  return Math.floor(Math.random() * Math.floor(max));
		}

		$("#hit").click(function() {

			var importsWidth = 0;
			var importsPlaced = 0;

			var extractionWidth = 0;
			var extractionPlaced = 0;

			var exportsWidth = 0;
			var exportsPlaced = 0;

			var consumptionWidth = 0;
			var consumptionPlaced = 0;

			$("a rect").each(function() {
				var newWidth = getRandomInt(40);
				$(this).attr("width", newWidth);
			});

			// imports
			$("rect.imports").each(function() {
				importsWidth = importsWidth + parseInt($(this).attr("width"));
			});

			$("rect.imports").each(function() {
				var startingX = 100 + (200 - importsWidth) / 2;
				var xPosition = startingX - importsPlaced;
				$(this).attr("x", xPosition);
				importsPlaced = importsPlaced - $(this).attr("width");
			});

			$("rect.importsTotal").attr("width", importsWidth);
			var firstImportsX = $("rect.imports:first-of-type").attr("x");
			$("rect.importsTotal").attr("x", firstImportsX);

			// extraction
			$("rect.extraction").each(function() {
				extractionWidth = extractionWidth + parseInt($(this).attr("width"));
			});

			$("rect.extraction").each(function() {
				var startingX = 400 + (200 - extractionWidth) / 2;
				var xPosition = startingX - extractionPlaced;
				$(this).attr("x", xPosition);
				extractionPlaced = extractionPlaced - $(this).attr("width");
			});

			$("rect.extractionTotal").attr("width", extractionWidth);
			var firstExtractionX = $("rect.extraction:first-of-type").attr("x");
			$("rect.extractionTotal").attr("x", firstExtractionX);


			// exports
			$("rect.exports").each(function() {
				exportsWidth = exportsWidth + parseInt($(this).attr("width"));
			});

			$("rect.exports").each(function() {
				var startingX = 100 + (200 - exportsWidth) / 2;
				var xPosition = startingX - exportsPlaced;
				$(this).attr("x", xPosition);
				exportsPlaced = exportsPlaced - $(this).attr("width");
			});

			$("rect.exportsTotal").attr("width", exportsWidth);
			var firstExportsX = $("rect.exports:first-of-type").attr("x");
			$("rect.exportsTotal").attr("x", firstExportsX);

			// consumption
			$("rect.consumption").each(function() {
				consumptionWidth = consumptionWidth + parseInt($(this).attr("width"));
			});

			$("rect.consumption").each(function() {
				var startingX = 400 + (200 - consumptionWidth) / 2;
				var xPosition = startingX - consumptionPlaced;
				$(this).attr("x", xPosition);
				consumptionPlaced = consumptionPlaced - $(this).attr("width");
			});

			$("rect.consumptionTotal").attr("width", consumptionWidth);
			var firstConsumptionX = $("rect.consumption:first-of-type").attr("x");
			$("rect.consumptionTotal").attr("x", firstConsumptionX);
		});
	</script>
</body>
</html>